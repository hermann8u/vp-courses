<!DOCTYPE html>
<html lang="fr-FR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Les services avec Symfony | Introduction à Symfony</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Licence Professionnelle SIL - Web et Mobile pour le Commerce Électronique">
    <meta name="robots" content="noindex, nofollow">
    
    <link rel="preload" href="/assets/css/0.styles.e2f7dcf9.css" as="style"><link rel="preload" href="/assets/js/app.f5ffb287.js" as="script"><link rel="preload" href="/assets/js/2.85d345eb.js" as="script"><link rel="preload" href="/assets/js/21.207e0e56.js" as="script"><link rel="prefetch" href="/assets/js/10.457dba52.js"><link rel="prefetch" href="/assets/js/11.08c438c2.js"><link rel="prefetch" href="/assets/js/12.cbc1776f.js"><link rel="prefetch" href="/assets/js/13.418be2c7.js"><link rel="prefetch" href="/assets/js/14.d52a0530.js"><link rel="prefetch" href="/assets/js/15.21450e21.js"><link rel="prefetch" href="/assets/js/16.872dd91c.js"><link rel="prefetch" href="/assets/js/17.b3e69a97.js"><link rel="prefetch" href="/assets/js/18.62e92111.js"><link rel="prefetch" href="/assets/js/19.e575b9c0.js"><link rel="prefetch" href="/assets/js/20.2dd543f1.js"><link rel="prefetch" href="/assets/js/22.d2fc0852.js"><link rel="prefetch" href="/assets/js/23.d71aaa5c.js"><link rel="prefetch" href="/assets/js/24.4a856b70.js"><link rel="prefetch" href="/assets/js/25.886f50e9.js"><link rel="prefetch" href="/assets/js/26.7345d31d.js"><link rel="prefetch" href="/assets/js/27.98540e6e.js"><link rel="prefetch" href="/assets/js/28.6a30ed2d.js"><link rel="prefetch" href="/assets/js/29.932c0b60.js"><link rel="prefetch" href="/assets/js/3.0cf10e4b.js"><link rel="prefetch" href="/assets/js/30.aa92a368.js"><link rel="prefetch" href="/assets/js/31.e026dfd1.js"><link rel="prefetch" href="/assets/js/32.0aec1f2e.js"><link rel="prefetch" href="/assets/js/33.9dd3d5d8.js"><link rel="prefetch" href="/assets/js/4.0a2f3beb.js"><link rel="prefetch" href="/assets/js/5.a33a2f42.js"><link rel="prefetch" href="/assets/js/6.f0091315.js"><link rel="prefetch" href="/assets/js/7.53d7b1d5.js"><link rel="prefetch" href="/assets/js/8.bae4ccb5.js"><link rel="prefetch" href="/assets/js/9.280a7124.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e2f7dcf9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Introduction à Symfony</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/cours/" class="nav-link router-link-active">
  Cours
</a></div><div class="nav-item"><a href="/projets/" class="nav-link">
  Projets
</a></div><div class="nav-item"><a href="/ressources/" class="nav-link">
  Ressources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/cours/" class="nav-link router-link-active">
  Cours
</a></div><div class="nav-item"><a href="/projets/" class="nav-link">
  Projets
</a></div><div class="nav-item"><a href="/ressources/" class="nav-link">
  Ressources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/cours/" aria-current="page" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/#qu-est-ce-qu-un-framework" class="sidebar-link">Qu'est ce qu'un framework ?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/#definition" class="sidebar-link">Définition</a></li><li class="sidebar-sub-header"><a href="/cours/#objectifs-d-un-framework" class="sidebar-link">Objectifs d'un framework</a></li><li class="sidebar-sub-header"><a href="/cours/#avantages-et-inconvenients-d-un-framework" class="sidebar-link">Avantages et inconvénients d'un framework</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/#decouvrir-symfony" class="sidebar-link">Découvrir Symfony</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/#presentation-generale" class="sidebar-link">Présentation générale</a></li><li class="sidebar-sub-header"><a href="/cours/#pourquoi-symfony-et-pas-un-autre" class="sidebar-link">Pourquoi Symfony et pas un autre ?</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/#pour-aller-plus-loin" class="sidebar-link">Pour aller plus loin</a></li></ul></li><li><a href="/cours/installation.html" class="sidebar-link">Installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/installation.html#prerequis" class="sidebar-link">Prérequis</a></li><li class="sidebar-sub-header"><a href="/cours/installation.html#telecharger-et-installer-symfony" class="sidebar-link">Télécharger et installer Symfony</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/installation.html#parenthese-sur-composer" class="sidebar-link">Parenthèse sur Composer</a></li><li class="sidebar-sub-header"><a href="/cours/installation.html#premier-projet-symfony" class="sidebar-link">Premier projet Symfony</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/installation.html#pour-aller-plus-loin" class="sidebar-link">Pour aller plus loin</a></li></ul></li><li><a href="/cours/structure.html" class="sidebar-link">Structure du projet</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/structure.html#la-console-de-symfony" class="sidebar-link">La console de Symfony</a></li><li class="sidebar-sub-header"><a href="/cours/structure.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/cours/structure.html#la-partie-publique" class="sidebar-link">La partie publique</a></li><li class="sidebar-sub-header"><a href="/cours/structure.html#le-code-source-php" class="sidebar-link">Le code source PHP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/structure.html#un-point-sur-le-kernel" class="sidebar-link">Un point sur le Kernel</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/structure.html#les-templates" class="sidebar-link">Les templates</a></li><li class="sidebar-sub-header"><a href="/cours/structure.html#les-fichiers-temporaires" class="sidebar-link">Les fichiers temporaires</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/structure.html#le-dossier-var-cache" class="sidebar-link">Le dossier /var/cache/</a></li><li class="sidebar-sub-header"><a href="/cours/structure.html#le-dossier-var-log" class="sidebar-link">Le dossier /var/log/</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/structure.html#les-dependances" class="sidebar-link">Les dépendances</a></li><li class="sidebar-sub-header"><a href="/cours/structure.html#les-variables-d-environnement" class="sidebar-link">Les variables d'environnement</a></li><li class="sidebar-sub-header"><a href="/cours/structure.html#la-configuration-de-composer" class="sidebar-link">La configuration de Composer</a></li></ul></li><li><a href="/cours/bundle-et-flex.html" class="sidebar-link">Bundles, Flex et auto-configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/bundle-et-flex.html#qu-est-ce-qu-un-bundle" class="sidebar-link">Qu'est ce qu'un bundle ?</a></li><li class="sidebar-sub-header"><a href="/cours/bundle-et-flex.html#symfony-et-flex" class="sidebar-link">Symfony et Flex</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/bundle-et-flex.html#nettoyage-du-projet" class="sidebar-link">Nettoyage du projet</a></li></ul></li></ul></li><li><a href="/cours/controleur-et-routing.html" class="sidebar-link">Contrôleur et Routing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#requete-et-reponse" class="sidebar-link">Requête et réponse</a></li><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#routing" class="sidebar-link">Routing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#fonctionnement" class="sidebar-link">Fonctionnement</a></li><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#configuration-d-une-route" class="sidebar-link">Configuration d'une route</a></li><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#les-parametres-d-une-route" class="sidebar-link">Les paramètres d'une route</a></li><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#debug-des-routes" class="sidebar-link">Debug des routes</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#controleur" class="sidebar-link">Contrôleur</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#generer-des-urls" class="sidebar-link">Générer des URLs</a></li><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#manipuler-l-objet-request" class="sidebar-link">Manipuler l'objet Request</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/controleur-et-routing.html#a-vous-de-jouer" class="sidebar-link">A vous de jouer</a></li></ul></li><li><a href="/cours/twig.html" class="sidebar-link">Le moteur de template Twig</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/twig.html#les-templates-dans-symfony" class="sidebar-link">Les templates dans Symfony</a></li><li class="sidebar-sub-header"><a href="/cours/twig.html#la-syntaxe-de-twig" class="sidebar-link">La syntaxe de Twig</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/twig.html#comparaison-entre-php-et-twig" class="sidebar-link">Comparaison entre PHP et Twig</a></li><li class="sidebar-sub-header"><a href="/cours/twig.html#les-filtres" class="sidebar-link">Les filtres</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/twig.html#integration-dans-symfony" class="sidebar-link">Intégration dans Symfony</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/twig.html#generation-de-lien" class="sidebar-link">Génération de lien</a></li><li class="sidebar-sub-header"><a href="/cours/twig.html#gestion-des-assets" class="sidebar-link">Gestion des assets</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/twig.html#heritage-de-templates" class="sidebar-link">Héritage de templates</a></li><li class="sidebar-sub-header"><a href="/cours/twig.html#a-vous-de-jouer" class="sidebar-link">A vous de jouer</a></li></ul></li><li><a href="/cours/formulaire.html" class="sidebar-link">Formulaires</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/formulaire.html#creation-d-un-objet-contact" class="sidebar-link">Création d'un objet Contact</a></li><li class="sidebar-sub-header"><a href="/cours/formulaire.html#creation-d-une-classe-de-formulaire" class="sidebar-link">Création d'une classe de formulaire</a></li><li class="sidebar-sub-header"><a href="/cours/formulaire.html#implementation-du-formulaire" class="sidebar-link">Implementation du formulaire</a></li><li class="sidebar-sub-header"><a href="/cours/formulaire.html#affichage-du-formulaire" class="sidebar-link">Affichage du formulaire</a></li><li class="sidebar-sub-header"><a href="/cours/formulaire.html#protection-csrf" class="sidebar-link">Protection CSRF</a></li><li class="sidebar-sub-header"><a href="/cours/formulaire.html#validation-du-formulaire" class="sidebar-link">Validation du formulaire</a></li><li class="sidebar-sub-header"><a href="/cours/formulaire.html#les-messages-flash" class="sidebar-link">Les messages flash</a></li><li class="sidebar-sub-header"><a href="/cours/formulaire.html#a-vous-de-jouer" class="sidebar-link">A vous de jouer</a></li></ul></li><li><a href="/cours/injection-dependances.html" class="sidebar-link">L'injection de dépendances</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/injection-dependances.html#definition" class="sidebar-link">Définition</a></li><li class="sidebar-sub-header"><a href="/cours/injection-dependances.html#le-conteneur-d-injection-de-dependances" class="sidebar-link">Le conteneur d'injection de dépendances</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/injection-dependances.html#les-factories" class="sidebar-link">Les factories</a></li><li class="sidebar-sub-header"><a href="/cours/injection-dependances.html#la-configuration" class="sidebar-link">La configuration</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/injection-dependances.html#l-autowiring" class="sidebar-link">L'Autowiring</a></li><li class="sidebar-sub-header"><a href="/cours/injection-dependances.html#pour-aller-plus-loin" class="sidebar-link">Pour aller plus loin</a></li></ul></li><li><a href="/cours/service.html" aria-current="page" class="active sidebar-link">Les services avec Symfony</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/service.html#les-services" class="sidebar-link">Les services</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/service.html#creer-un-service" class="sidebar-link">Créer un service</a></li><li class="sidebar-sub-header"><a href="/cours/service.html#utiliser-un-service" class="sidebar-link">Utiliser un service</a></li><li class="sidebar-sub-header"><a href="/cours/service.html#lister-les-services-graces-a-la-console" class="sidebar-link">Lister les services grâces à la console</a></li><li class="sidebar-sub-header"><a href="/cours/service.html#configuration" class="sidebar-link">Configuration</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/service.html#les-parametres" class="sidebar-link">Les paramètres</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/service.html#utilite-et-definition" class="sidebar-link">Utilité et définition</a></li><li class="sidebar-sub-header"><a href="/cours/service.html#utilisation-dans-la-configuration" class="sidebar-link">Utilisation dans la configuration</a></li><li class="sidebar-sub-header"><a href="/cours/service.html#utilisation-dans-un-service" class="sidebar-link">Utilisation dans un service</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/service.html#exemple-utilisation-du-mailer" class="sidebar-link">Exemple : Utilisation du Mailer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/service.html#l-envoi-d-un-email" class="sidebar-link">L'envoi d'un email</a></li><li class="sidebar-sub-header"><a href="/cours/service.html#analyser-ses-envois" class="sidebar-link">Analyser ses envois</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/service.html#a-vous-de-jouer" class="sidebar-link">A vous de jouer</a></li><li class="sidebar-sub-header"><a href="/cours/service.html#pour-aller-plus-loin" class="sidebar-link">Pour aller plus loin</a></li></ul></li><li><a href="/cours/entities.html" class="sidebar-link">Les entités Doctrine</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/entities.html#creer-une-entite" class="sidebar-link">Créer une entité</a></li><li class="sidebar-sub-header"><a href="/cours/entities.html#gerer-l-etat-de-la-base-de-donnees" class="sidebar-link">Gérer l'état de la base de données</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/entities.html#les-migrations" class="sidebar-link">Les migrations</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/entities.html#interagir-avec-doctrine" class="sidebar-link">Interagir avec Doctrine</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/entities.html#insertion" class="sidebar-link">Insertion</a></li><li class="sidebar-sub-header"><a href="/cours/entities.html#modification" class="sidebar-link">Modification</a></li><li class="sidebar-sub-header"><a href="/cours/entities.html#suppression" class="sidebar-link">Suppression</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/entities.html#des-donnees-de-developpement" class="sidebar-link">Des données de développement</a></li><li class="sidebar-sub-header"><a href="/cours/entities.html#a-vous-de-jouer" class="sidebar-link">A vous de jouer</a></li><li class="sidebar-sub-header"><a href="/cours/entities.html#pour-aller-plus-loin" class="sidebar-link">Pour aller plus loin</a></li></ul></li><li><a href="/cours/relations.html" class="sidebar-link">Relations entre entités</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/relations.html#quelques-notions-importantes" class="sidebar-link">Quelques notions importantes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/relations.html#notion-de-proprietaire-et-d-inverse" class="sidebar-link">Notion de propriétaire et d'inverse</a></li><li class="sidebar-sub-header"><a href="/cours/relations.html#notion-d-unidirectionnalite-et-de-bidirectionnalite" class="sidebar-link">Notion d'unidirectionnalité et de bidirectionnalité</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/relations.html#les-types-de-relations" class="sidebar-link">Les types de relations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/relations.html#relation-onetoone" class="sidebar-link">Relation OneToOne</a></li><li class="sidebar-sub-header"><a href="/cours/relations.html#relation-manytoone" class="sidebar-link">Relation ManyToOne</a></li><li class="sidebar-sub-header"><a href="/cours/relations.html#relation-manytomany" class="sidebar-link">Relation ManyToMany</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/relations.html#a-vous-de-jouer" class="sidebar-link">A vous de jouer</a></li></ul></li><li><a href="/cours/repositories.html" class="sidebar-link">Les repositories</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/repositories.html#les-methodes-de-construction-de-query" class="sidebar-link">Les méthodes de construction de query</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/repositories.html#doctrine-query-language-dql" class="sidebar-link">Doctrine Query Language (DQL)</a></li><li class="sidebar-sub-header"><a href="/cours/repositories.html#querybuilder" class="sidebar-link">QueryBuilder</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/repositories.html#recuperer-ses-entites" class="sidebar-link">Récupérer ses entités</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/repositories.html#les-methodes-de-base" class="sidebar-link">Les méthodes de base</a></li><li class="sidebar-sub-header"><a href="/cours/repositories.html#les-methodes-magiques" class="sidebar-link">Les méthodes magiques</a></li><li class="sidebar-sub-header"><a href="/cours/repositories.html#vos-propres-methodes" class="sidebar-link">Vos propres méthodes</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/repositories.html#a-vous-de-jouer" class="sidebar-link">A vous de jouer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/repositories.html#aides" class="sidebar-link">Aides</a></li></ul></li></ul></li><li><a href="/cours/event-dispatcher.html" class="sidebar-link">L'event dispatcher</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/event-dispatcher.html#le-principe" class="sidebar-link">Le principe</a></li><li class="sidebar-sub-header"><a href="/cours/event-dispatcher.html#envoyer-des-evenements" class="sidebar-link">Envoyer des événements</a></li><li class="sidebar-sub-header"><a href="/cours/event-dispatcher.html#ecouter-les-evenements" class="sidebar-link">Écouter les événements</a></li><li class="sidebar-sub-header"><a href="/cours/event-dispatcher.html#a-vous-de-jouer" class="sidebar-link">A vous de jouer</a></li><li class="sidebar-sub-header"><a href="/cours/event-dispatcher.html#pour-aller-plus-loin" class="sidebar-link">Pour aller plus loin</a></li></ul></li><li><a href="/cours/mise-en-ligne.html" class="sidebar-link">La mise en ligne</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#personnaliser-les-pages-d-erreur" class="sidebar-link">Personnaliser les pages d'erreur</a></li><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#verifier-son-site-symfony" class="sidebar-link">Vérifier son site Symfony</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#tester-son-application" class="sidebar-link">Tester son application</a></li><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#verifier-la-qualite-du-code" class="sidebar-link">Vérifier la qualité du code</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#deployer-son-site-symfony-en-ligne" class="sidebar-link">Déployer son site Symfony en ligne</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#sans-acces-ssh" class="sidebar-link">Sans accès SSH</a></li><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#avec-acces-ssh" class="sidebar-link">Avec accès SSH</a></li><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#explications-en-details" class="sidebar-link">Explications en détails</a></li></ul></li><li class="sidebar-sub-header"><a href="/cours/mise-en-ligne.html#pour-aller-plus-loin" class="sidebar-link">Pour aller plus loin</a></li></ul></li><li><a href="/cours/plus-loin.html" class="sidebar-link">Pour aller plus loin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/plus-loin.html#sur-symfony" class="sidebar-link">Sur Symfony</a></li><li class="sidebar-sub-header"><a href="/cours/plus-loin.html#s-ameliorer" class="sidebar-link">S'améliorer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cours/plus-loin.html#pourquoi" class="sidebar-link">Pourquoi</a></li><li class="sidebar-sub-header"><a href="/cours/plus-loin.html#comment" class="sidebar-link">Comment</a></li><li class="sidebar-sub-header"><a href="/cours/plus-loin.html#comment-apprendre" class="sidebar-link">Comment apprendre ?</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="les-services-avec-symfony"><a href="#les-services-avec-symfony" class="header-anchor">#</a> Les services avec Symfony</h1> <p>Notre application est déjà remplie de services. Par exemple, dans le chapitre sur les formulaires, nous avons utilisé le <strong>FlashBag</strong> afin de gérer les messages flash.</p> <p>Vous l'aurez compris, les services sont omniprésent à travers le framework. Ils sont chacun responsable de tâches bien spécifiques. Parmi les services que nous avons déjà utilisés sans que vous vous en aperceviez, nous pouvons citer :</p> <ul><li>Le Router</li> <li>La FormFactory</li> <li>Twig</li> <li>La Session</li></ul> <p>Ces services sont un peu particuliers car ils sont mis à disposition de manière transparente à travers des méthodes de l'<strong>AbstractController</strong> que nos contrôleurs étendent.</p> <h2 id="les-services"><a href="#les-services" class="header-anchor">#</a> Les services</h2> <h3 id="creer-un-service"><a href="#creer-un-service" class="header-anchor">#</a> Créer un service</h3> <p>Le but des services restent de segmenter notre code en briques réutilisables plus petites. Vous l'aurez compris, nous allons utiliser l'autowiring dans notre application. Ainsi, la création de service consiste simplement en la création d'une classe !</p> <p>Imaginons que nous voudrions afficher un message aléatoire sur plusieurs pages de notre site, nous pourrions le faire à partir d'un service :</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">// Ici le namespace est App\Service mais ça aurait pu être App\NimporteQuoi.</span>
<span class="token comment">// Nous verrons après pourquoi.</span>
<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Service</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">MessageGenerator</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getRandomMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$messages</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'You did it! You updated the system! Amazing!'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'That was one of the coolest updates I\'ve seen all day!'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'Great work! Keep going!'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token variable">$index</span> <span class="token operator">=</span> <span class="token function">array_rand</span><span class="token punctuation">(</span><span class="token variable">$messages</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$messages</span><span class="token punctuation">[</span><span class="token variable">$index</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>Il ne nous reste plus qu'à l'utiliser</p> <h3 id="utiliser-un-service"><a href="#utiliser-un-service" class="header-anchor">#</a> Utiliser un service</h3> <p>L'utilisation d'un service se réduira à utiliser l'injection de dépendance, encore une fois, sans étape de configuration supplémentaire grâce à l'autowiring :</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// ...</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Service<span class="token punctuation">\</span>MessageGenerator</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ProductController</span>
<span class="token punctuation">{</span>
    <span class="token comment">/** @var MessageGenerator */</span>
    <span class="token keyword">private</span> <span class="token variable">$messageGenerator</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token class-name type-declaration">MessageGenerator</span> <span class="token variable">$messageGenerator</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">messageGenerator</span> <span class="token operator">=</span> <span class="token variable">$messageGenerator</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
    * @Route(&quot;/products&quot;)
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Response</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$message</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">messageGenerator</span><span class="token operator">-&gt;</span><span class="token function">getRandomMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Vous l'aurez peut être compris, nos contrôleurs sont eux-meme des services, sinon, l'exemple précédent ne serait pas possible.</p></div> <h3 id="lister-les-services-graces-a-la-console"><a href="#lister-les-services-graces-a-la-console" class="header-anchor">#</a> Lister les services grâces à la console</h3> <p>Afin de <strong>lister tous les services</strong> que vous pouvez injecter avec l'<strong>autowiring</strong>, vous pouvez utiliser la commande suivante:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>php bin/console debug:autowiring
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Certains services sont également utilisés par Symfony pour réaliser des tâches <strong>internes au framework</strong>. Ils ne sont pas forcement disponible pour l'autowiring car vous n'avez pas besoin de les utiliser. Il existe quand même une commande pour <strong>lister tous les services de l'application</strong>.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>php bin/console debug:container
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h3> <p>Nous n'y échapperons pas, il faut quand même jetez un coup d'oeil au fichier de configuration <strong>/config/services.yaml</strong> pour voir comment ça fonctionne :</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">services</span><span class="token punctuation">:</span>
    <span class="token comment"># default configuration for services in *this* file</span>
    <span class="token key atrule">_defaults</span><span class="token punctuation">:</span>
        <span class="token key atrule">autowire</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>      <span class="token comment"># Automatically injects dependencies in your services.</span>
        <span class="token key atrule">autoconfigure</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># Automatically registers your services as commands, event subscribers, etc.</span>

    <span class="token comment"># makes classes in src/ available to be used as services</span>
    <span class="token comment"># this creates a service per class whose id is the fully-qualified class name</span>
    <span class="token key atrule">App\</span><span class="token punctuation">:</span>
        <span class="token key atrule">resource</span><span class="token punctuation">:</span> <span class="token string">'../src/'</span>
        <span class="token key atrule">exclude</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token string">'../src/DependencyInjection/'</span>
            <span class="token punctuation">-</span> <span class="token string">'../src/Entity/'</span>
            <span class="token punctuation">-</span> <span class="token string">'../src/Kernel.php'</span>
            <span class="token punctuation">-</span> <span class="token string">'../src/Tests/'</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Sous la clé <em>services._defaults</em>, on définie une configuration globales pour tous les services que nous allons déclarer. Nous indiquons ensuite à Symfony de considérer tous les fichiers du namespace App comme étant des services, en prenant soin d'exclure quelques exceptions.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Dans le cas des <strong>contrôleurs</strong>, on peut injecter les services soit avec le <strong>constructeur</strong>, soit dans nos <strong>actions</strong> directement. Si les deux méthodes fonctionnent, on préférera utiliser uniquement l'injection depuis le constructeur, notamment afin d'éviter de mélanger les paramètres qui proviennent du routing avec les dépendances.</p></div> <h2 id="les-parametres"><a href="#les-parametres" class="header-anchor">#</a> Les paramètres</h2> <p>Nous allons profiter d'être dans le fichier <strong>/config/services.yaml</strong> pour parler des paramètres de l'application. Ils peuvent d'ailleurs être, à juste titre, utilisés comme des dépendances pour nos services.</p> <h3 id="utilite-et-definition"><a href="#utilite-et-definition" class="header-anchor">#</a> Utilité et définition</h3> <p>Nous avons déjà vu que les paramètres sensibles et ceux dépendant de la machine se gèrent dans les fichiers <strong>/.env*</strong>, mais il peut être intéressant de disposer d'autres paramètres en rapport direct avec notre projet. Par exemple, la langue par défaut de notre site, ou l'adresse email de réception pour notre formulaire de contact.</p> <p>Au lieu de définir en dure et à plusieurs endroits ces paramètres, nous pouvons les définir dans ce fichier sous la clé <strong>parameters</strong> :</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">parameters</span><span class="token punctuation">:</span>
    <span class="token key atrule">app.locale</span><span class="token punctuation">:</span> <span class="token string">'fr'</span>
    <span class="token key atrule">app.email_address.contact</span><span class="token punctuation">:</span> <span class="token string">'contact@shoefony.com'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="utilisation-dans-la-configuration"><a href="#utilisation-dans-la-configuration" class="header-anchor">#</a> Utilisation dans la configuration</h3> <p>Maintenant qu'ils sont définis, on peut les utiliser dans toutes la configuration. Nous allons modifier la locale par défaut de notre site dans le fichier <strong>/config/packages/framework.yaml</strong> :</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">framework</span><span class="token punctuation">:</span>
    <span class="token comment"># ...</span>
    <span class="token key atrule">default_locale</span><span class="token punctuation">:</span> <span class="token string">'%app.locale%'</span>
    <span class="token comment"># ...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Comme vous pouvez le voir, pour les utiliser dans la configuration, il suffit d'entourer le nom que nous avons utilisé pour définir le paramètre par <strong>deux symboles %</strong>. D'ailleurs, les paramètres se concatènent très bien avec une autre chaîne de caractères. Par exemple dans le fichier de configuration de Twig :</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">twig</span><span class="token punctuation">:</span>
    <span class="token key atrule">default_path</span><span class="token punctuation">:</span> <span class="token string">'%kernel.project_dir%/templates'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Dans cet exemple, nous utilisons un paramètre fournit par Symfony qui contient le chemin complet vers la racine de notre projet. C'est très souvent utilisé pour obtenir le chemin complet vers un fichier, ou ici un dossier, en concaténant.</p></div> <h3 id="utilisation-dans-un-service"><a href="#utilisation-dans-un-service" class="header-anchor">#</a> Utilisation dans un service</h3> <p>Les paramètres peuvent aussi s'injecter en dépendances de services avec l'autowiring ! Mais pour que ça fonctionne, il faut faire un peu de configuration :</p> <div class="language-yaml line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-yaml"><code><span class="token key atrule">parameters</span><span class="token punctuation">:</span>
    <span class="token key atrule">app.locale</span><span class="token punctuation">:</span> <span class="token string">'fr'</span>
    <span class="token key atrule">app.email_address.contact</span><span class="token punctuation">:</span> <span class="token string">'contact@shoefony.com'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
    <span class="token key atrule">_defaults</span><span class="token punctuation">:</span>
        <span class="token key atrule">autowire</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
        <span class="token key atrule">autoconfigure</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

        <span class="token key atrule">bind</span><span class="token punctuation">:</span>
            <span class="token key atrule">string $projectDir</span><span class="token punctuation">:</span> <span class="token string">'%kernel.project_dir%'</span>
            <span class="token key atrule">string $contactEmailAddress</span><span class="token punctuation">:</span> <span class="token string">'%app.email_address.contact%'</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Voilà qui permet d'obtenir ces deux paramètres de manière global pour l'injection de dépendances. Pour que ça fonctionne, il faut que le type et le nom de l'argument du constructeur du service correspondent avec ceux définis sous la clé <strong>bind</strong> :</p> <div class="language-php line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name-definition class-name">AnotherService</span>
<span class="token punctuation">{</span>
    <span class="token comment">/** @var string */</span>
    <span class="token keyword">private</span> <span class="token variable">$projectDir</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$projectDir</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">projectDir</span> <span class="token operator">=</span> <span class="token variable">$projectDir</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="exemple-utilisation-du-mailer"><a href="#exemple-utilisation-du-mailer" class="header-anchor">#</a> Exemple : Utilisation du Mailer</h2> <p>Nous allons maintenant pouvoir pratiquer l'injection de dépendances avec un cas concret : l'utilisation du <a href="https://symfony.com/doc/current/components/mailer.html" target="_blank" rel="noopener noreferrer">composant Mailer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Ce composant est, comme beaucoup, intégré à Symfony à travers le <strong>FrameworkBundle</strong>.</p> <p>Afin de l'utiliser, il faut commencer par le configurer, mais Symfony Flex a déjà fait une bonne partie du travail pour nous. Voici les étapes étapes qu'il nous reste à faire :</p> <ol><li>Installer un <a href="https://symfony.com/doc/current/mailer.html#using-a-3rd-party-transport" target="_blank" rel="noopener noreferrer">provider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> pour l'envoi d'email en fonction de vos besoin ou utiliser le <strong>SMTP</strong> (par défaut)</li> <li>Comme nous ne l'avons pas encore fait, il faut dupliquer le fichier <strong>/.env</strong> en <strong>/.env.local</strong> afin d'y ajouter vos données sensibles.</li> <li>Dans le fichier <strong>/.env.local</strong>, modifier le paramètre <strong>MAILER_DSN</strong> en <a href="https://symfony.com/doc/current/components/mailer.html#mailer-dsn" target="_blank" rel="noopener noreferrer">fonction du provider choisit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>L'envoi de mail en locale est toujours quelque chose qui reste bancale. C'est possible que, même si votre configuration est bonne, rien ne se passe.</p></div> <h3 id="l-envoi-d-un-email"><a href="#l-envoi-d-un-email" class="header-anchor">#</a> L'envoi d'un email</h3> <p>Le composant fonctionne grâce à la création, la configuration et enfin à l'envoi d'objets <strong>Symfony\Component\Mime\Email</strong>. Le service <strong>Mailer</strong> est responsable de l'envoi réel du message à travers sa méthode <strong>send</strong>.</p> <p>Voici comment générer un message :</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// ...</span>
<span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Mailer<span class="token punctuation">\</span>MailerInterface</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Mime<span class="token punctuation">\</span>Email</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token variable">$email</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Email</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hello@example.com'</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'contact@shoefony.com'</span><span class="token punctuation">)</span>
    <span class="token comment">//-&gt;cc('cc@example.com')</span>
    <span class="token comment">//-&gt;bcc('bcc@example.com')</span>
    <span class="token comment">//-&gt;replyTo('hello@example.com')</span>
    <span class="token comment">//-&gt;priority(Email::PRIORITY_HIGH)</span>
    <span class="token operator">-&gt;</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Un message de contact sur Shoefony'</span><span class="token punctuation">)</span>
    <span class="token operator">-&gt;</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token variable">$twig</span><span class="token operator">-&gt;</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'email/contact.html.twig'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'contact'</span> <span class="token operator">=&gt;</span> <span class="token variable">$contact</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$mailer</span><span class="token operator">-&gt;</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token variable">$email</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Pour garder les choses découplées, le corps de l'email a été stocké dans un template et est rendu grâce à la méthode <strong>render()</strong> de la classe <strong>Twig\Environment</strong>.</p> <p>L'objet <strong>Symfony\Component\Mime\Email</strong> supporte beaucoup plus d'options, comme inclure des pièces jointes, et bien plus encore.</p> <p>A noter qu'en plus d'indiquer des adresses &quot;to&quot;, vous pouvez ajouter des destinataires en copie ou copie cachée via &quot;cc&quot;, etc...</p> <h3 id="analyser-ses-envois"><a href="#analyser-ses-envois" class="header-anchor">#</a> Analyser ses envois</h3> <p>Vous pouvez voir tous les emails envoyés durant une unique réponse lorsque vous êtes dans l'environnement dev via <strong>la barre de debug</strong>. L'icône d'email dans la barre d'outils montrera combien d'emails ont été envoyés. Si vous cliquez dessus, un rapport s'ouvrira montrant les détails des emails envoyés.</p> <p>Si vous envoyez un email et puis redirigez immédiatement vers une autre page, la barre d'outils de debug n'affichera pas d'icône d'email ni de rapport sur la page d'après.</p> <p>Il est possible d'<strong>intercepter cette redirection</strong> grâce à une configuration du <strong>WebProfilerBundle</strong>. Nous allons activer cette option uniquement pour le développement, dans le fichier <strong>/config/dev/web_profiler.yaml</strong>.</p> <div class="language-yaml line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br></div><pre class="language-yaml"><code><span class="token key atrule">web_profiler</span><span class="token punctuation">:</span>
    <span class="token key atrule">toolbar</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">intercept_redirects</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="a-vous-de-jouer"><a href="#a-vous-de-jouer" class="header-anchor">#</a> A vous de jouer</h2> <p>Améliorons à présent notre formulaire de contact afin d'alerter l'administrateur lorsqu'une nouvelle demande est envoyée.</p> <ol><li>Ajoutez les paramètres <strong>app.locale</strong> et <strong>app.email_address.contact</strong> dans le bon fichier et configurez la locale par défaut de votre application avec le premier.</li> <li>Ajoutez le <strong>bind</strong> pour le paramètre <strong>app.email_address.contact</strong>.</li> <li>Configurez le composant <strong>Mailer</strong> afin de pouvoir envoyer des emails depuis votre projet.</li> <li>Créez un service <strong>App\Mailer\ContactMailer</strong> et injectez-y le service <strong>Mailer</strong>, le service de <strong>Twig</strong> et le paramètre <strong>app.email_address.contact</strong>. Vérifiez ensuite que ça fonctionne avec la fonction de debug <strong>dd()</strong>.</li> <li>Ajoutez une méthode <strong>send</strong> qui prendra en paramètre notre entité de contact et qui utilisera les dépendances de notre service pour procéder à l'envoi. Le contenu de l'email devra être généré grâce à Twig.</li> <li>Injectez notre service dans le <strong>MainController</strong> et utilisez sa méthode après la validation des données.</li> <li>Testez le résultat grâce à la barre de debug.</li></ol> <h2 id="pour-aller-plus-loin"><a href="#pour-aller-plus-loin" class="header-anchor">#</a> Pour aller plus loin</h2> <ul><li><a href="https://symfony.com/doc/current/best_practices.html#business-logic" target="_blank" rel="noopener noreferrer">Symfony best practices : Organizing Your Business Logic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://symfony.com/doc/current/best_practices.html#configuration" target="_blank" rel="noopener noreferrer">Symfony best practices : Configuration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://symfony.com/doc/current/mailer.html" target="_blank" rel="noopener noreferrer">Documentation de Symfony sur l'envoi d'email<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cours/injection-dependances.html" class="prev">
        L'injection de dépendances
      </a></span> <span class="next"><a href="/cours/entities.html">
        Les entités Doctrine
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f5ffb287.js" defer></script><script src="/assets/js/2.85d345eb.js" defer></script><script src="/assets/js/21.207e0e56.js" defer></script>
  </body>
</html>
